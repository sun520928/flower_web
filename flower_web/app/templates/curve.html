{% extends 'base.html' %}

{% block title %}
{{ supper() }}
{% endblock %}

{% block body %}
	<!--为ECharts准备一个具备大小（宽高）的Dom-->
	<div id="chart" style="height:500px;border:1px solid #ccc;padding:10px;"></div>
	<script type="text/javascript">
	var myChart = echarts.init(document.getElementById('chart'));
	// 显示标题，图例和空的坐标轴
	myChart.setOption({
		title: {
			text: '传感器数据显示'
		},
		tooltip: {},
		legend: {
			data:['空气最高温度', '空气最低温度', '空气最高湿度', '空气最低湿度']
		},
		xAxis: {
			data: list(range(100))
		},
		yAxis: {
			data: []
		},
		series: [{
			name: '空气最高温度',
			type: 'line',
			data: []
		},
		{
			name: '空气最低温度',
			type: 'line',
			data: []
		},
		{
			name: '空气最高湿度',
			type: 'line',
			data: []
		},
		{
			name: '空气最低湿度',
			type: 'line',
			data: []
		}]
	});

	myChart.showLoading(); // 显示加载动画

	// 异步加载数据
	$.get('/air').done(function (data) {
		myChart.hideLoading(); // 隐藏加载动画

		// 填入数据
		myChart.setOption({
			yAxis: {
				data: data.result.update_date
			},
			series: [{
				name: '空气最高温度', // 根据名字对应到相应的系列
				data: data.result.max_celsius.map(parseFloat) // 转化为数字（注意map）
			},
			{
				name: '空气最低温度', // 根据名字对应到相应的系列
				data: data.result.min_celsius.map(parseFloat) // 转化为数字（注意map）
			},
			{
				name: '空气最高湿度',
				data: data.result.max_humidity.map(parseFloat)
			},
			{
				name: '空气最低湿度',
				data: data.result.min_humidity.map(parseFloat)
			}]
		});
	});
	</script>
{% endblock %}


{% block js %}
{{ supper() }}
<script src="{{ url_for('static', filename='js/echarts.js') }}"></script>
{% endblock %}

